<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Fullscreen Video Slideshow with BigVideo.js</title>
    <meta name="viewport" content="width=device-width">
    <link rel="shortcut icon" href="../favicon.ico"> 
    <link href='http://fonts.googleapis.com/css?family=Open+Sans+Condensed:700,300' rel='stylesheet' type='text/css' />
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/bigvideo.css">
    <script src="js/modernizr-2.5.3.min.js"></script>
  
  <!--Rise Storage Web Component Dependencies-->
  <script src="bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>
  <link rel="import" href="rise-storage.html">
</head>
<body>
<!-- Rise Storage Web Component Tag-->
    <rise-storage id="sorting" companyId="395c64e5-2930-460b-881e-009aabb157df" folder="content-video-storage"
    sort="name" sortDirection="asc" ></rise-storage>
 <div class="shade"></div>

    <!-- Codrops top bar -->
    <div class="codrops-top">
        <a href="http://tympanus.net/Tutorials/CSS3ButtonSwitches/">
            <strong>&laquo; Previous Demo: </strong>CSS3 Button Switches
        </a>
        <span class="right">
            <a href="http://beachfrontprod.blogspot.com/">Videos by Beachfront B-Roll</a>
            <a href="http://tympanus.net/codrops/2012/09/19/fullscreen-video-slideshow-with-bigvideo-js/">
                <strong>Back to the Codrops Article</strong>
            </a>
        </span>
        <div class="clr"></div>
    </div><!--/ Codrops top bar -->

    <header>
        <h1>Fullscreen Video Slideshow <span>with BigVideo.js</span></h1>
        <p>The videos in this demo are from <a href="http://beachfrontprod.blogspot.com" target="_blank">Beachfront B-Roll</a>, a great place to download unique HD stock video footage and animated backgrounds for any production purpose (for free!).</p>
        <p><small>A demo for</small> <a href="http://dfcb.github.com/BigVideo.js/" target="_blank">BigVideo.js</a> <small>by <a href="http://twitter.com/johnpolacek" target="_blank" rel="author">@johnpolacek</a></small></p>
    </header>

    <div class="wrapper">
        <div class="screen">
            <video id="video1" data-autopause="false" data-mute="true" data-loop="true" data-fill-mode="fill" autoplay loop>
    <source id="screen-1" src="" type="video/webm">
  </video>
            <h1 class="video-title">#1 Bird</h1>
        </div>
        <div class="screen">
            <video id="video2" data-autopause="false" data-mute="true" data-loop="true" data-fill-mode="fill" autoplay loop>
    <source id="screen-2"  src="" type="video/webm">
  </video>
            <h1 class="video-title">#2 Satellite</h1>
        </div>
        <div class="screen">
            <video id="video3" data-autopause="false" data-mute="true" data-loop="true" data-fill-mode="fill" autoplay loop>
    <source id="screen-3" src="" type="video/webm">
  </video>
            <h1 class="video-title">#3 Camera</h1>
        </div>
        <div class="screen">
           <video id="video4" data-autopause="false" data-mute="true" data-loop="true" data-fill-mode="fill" autoplay loop>
    <source id="screen-4" src="" type="video/webm">
  </video>
            <h1 class="video-title">#4 Spider</h1>
        </div>
      
    </div>

    <nav id="next-btn">
        <a href="#" class="next-icon"></a>
    </nav>

    <!-- BigVideo Dependencies -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.8.1.min.js"><\/script>')</script>
    <script src="js/jquery-ui-1.8.22.custom.min.js"></script>
    <script src="js/jquery.imagesloaded.min.js"></script>
    <script src="http://vjs.zencdn.net/c/video.js"></script>

    <!-- BigVideo -->
    <script src="js/bigvideo.js"></script>

    <!-- Tutorial Demo -->
    <script src="js/jquery.transit.min.js"></script>
    <script>
        $(function() {

            // Use Modernizr to detect for touch devices, 
            // which don't support autoplay and may have less bandwidth, 
            // so just give them the poster images instead
            var screenIndex = 1,
                numScreens = $('.screen').length,
                isTransitioning = false,
                transitionDur = 1000,
                BV,
                videoPlayer,
                isTouch = Modernizr.touch,
                $bigImage = $('.big-image'),
                $window = $(window);
            
            if (!isTouch) {
                // initialize BigVideo
                BV = new $.BigVideo({forceAutoplay:isTouch});
                BV.init();
                showVideo();
                
                BV.getPlayer().addEvent('loadeddata', function() {
                    onVideoLoaded();
                });

                // adjust image positioning so it lines up with video
                $bigImage
                    .css('position','relative')
                    .imagesLoaded(adjustImagePositioning);
                // and on window resize
                $window.on('resize', adjustImagePositioning);
            }
            
            // Next button click goes to next div
            $('#next-btn').on('click', function(e) {
                e.preventDefault();
                if (!isTransitioning) {
                    next();
                }
            });

            function showVideo() {
                BV.show($('#screen-'+screenIndex).attr('src'),{ambient:true});
            }

            function next() {
                isTransitioning = true;
                
                // update video index, reset image opacity if starting over
                if (screenIndex === numScreens) {
                    $bigImage.css('opacity',1);
                    screenIndex = 1;
                } else {
                    screenIndex++;
                }
                
                if (!isTouch) {
                    $('#big-video-wrap').transit({'left':'-100%'},transitionDur)
                }
                    
                (Modernizr.csstransitions)?
                    $('.wrapper').transit(
                        {'left':'-'+(100*(screenIndex-1))+'%'},
                        transitionDur,
                        onTransitionComplete):
                    onTransitionComplete();
            }

            function onVideoLoaded() {
                $('#screen-'+screenIndex).find('.big-image').transit({'opacity':0},500)
            }

            function onTransitionComplete() {
                isTransitioning = false;
                if (!isTouch) {
                    $('#big-video-wrap').css('left',0);
                    showVideo();
                }
            }

            function adjustImagePositioning() {
                $bigImage.each(function(){
                    var $img = $(this),
                        img = new Image();

                    img.src = $img.attr('src');

                    var windowWidth = $window.width(),
                        windowHeight = $window.height(),
                        r_w = windowHeight / windowWidth,
                        i_w = img.width,
                        i_h = img.height,
                        r_i = i_h / i_w,
                        new_w, new_h, new_left, new_top;

                    if( r_w > r_i ) {
                        new_h   = windowHeight;
                        new_w   = windowHeight / r_i;
                    }
                    else {
                        new_h   = windowWidth * r_i;
                        new_w   = windowWidth;
                    }

                    $img.css({
                        width   : new_w,
                        height  : new_h,
                        left    : ( windowWidth - new_w ) / 2,
                        top     : ( windowHeight - new_h ) / 2
                    })

                });

            }
        });
    </script>
  
<!--Script for Rise Storage Demo Component-->
  <script>
    var storage = document.querySelector("rise-storage"),  
    video1 = document.querySelector("#video1");
    video2 = document.querySelector("#video2");
    video3 = document.querySelector("#video3");
    video4 = document.querySelector("#video4");

    storage.addEventListener("rise-storage-response", function(e) {
    video1.setAttribute("src", e.detail.files[5].url);
    video2.setAttribute("src", e.detail.files[6].url);
    video3.setAttribute("src", e.detail.files[7].url);
    video4.setAttribute("src", e.detail.files[8].url);

    });
  </script>
</body>
</html>